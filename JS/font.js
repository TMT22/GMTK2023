
// https://github.com/PaulBGD/PixelFont/blob/master/script.js
    var letters = letters = {
        ',': [
            [, ],
            [, ],
            [, ],
            [, 1],
            [1, ]
        ],
        'A': [
            [, 1],
            [1, , 1],
            [1, , 1],
            [1, 1, 1],
            [1, , 1]
        ],
        'B': [
            [1, 1],
            [1, , 1],
            [1, 1, 1],
            [1, , 1],
            [1, 1]
        ],
        'C': [
            [1, 1, 1],
            [1],
            [1],
            [1],
            [1, 1, 1]
        ],
        'D': [
            [1, 1],
            [1, , 1],
            [1, , 1],
            [1, , 1],
            [1, 1]
        ],
        'E': [
            [1, 1, 1],
            [1],
            [1, 1, 1],
            [1],
            [1, 1, 1]
        ],
        'F': [
            [1, 1, 1],
            [1],
            [1, 1],
            [1],
            [1]
        ],
        'G': [
            [, 1, 1],
            [1],
            [1, , 1, 1],
            [1, , , 1],
            [, 1, 1]
        ],
        'H': [
            [1, , 1],
            [1, , 1],
            [1, 1, 1],
            [1, , 1],
            [1, , 1]
        ],
        'I': [
            [1, 1, 1],
            [, 1],
            [, 1],
            [, 1],
            [1, 1, 1]
        ],
        'J': [
            [1, 1, 1],
            [, , 1],
            [, , 1],
            [1, , 1],
            [1, 1, 1]
        ],
        'K': [
            [1, , , 1],
            [1, , 1],
            [1, 1],
            [1, , 1],
            [1, , , 1]
        ],
        'L': [
            [1],
            [1],
            [1],
            [1],
            [1, 1, 1]
        ],
        'M': [
            [1, 1, 1, 1, 1],
            [1, , 1, , 1],
            [1, , 1, , 1],
            [1, , , , 1],
            [1, , , , 1]
        ],
        'N': [
            [1, , , 1],
            [1, 1, , 1],
            [1, , 1, 1],
            [1, , , 1],
            [1, , , 1]
        ],
        'O': [
            [1, 1, 1],
            [1, , 1],
            [1, , 1],
            [1, , 1],
            [1, 1, 1]
        ],
        'P': [
            [1, 1, 1],
            [1, , 1],
            [1, 1, 1],
            [1],
            [1]
        ],
        'Q': [
            [0, 1, 1],
            [1, , , 1],
            [1, , , 1],
            [1, , 1, 1],
            [1, 1, 1, 1]
        ],
        'R': [
            [1, 1],
            [1, , 1],
            [1, , 1],
            [1, 1],
            [1, , 1]
        ],
        'S': [
            [1, 1, 1],
            [1],
            [1, 1, 1],
            [, , 1],
            [1, 1, 1]
        ],
        'T': [
            [1, 1, 1],
            [, 1],
            [, 1],
            [, 1],
            [, 1]
        ],
        'U': [
            [1, , 1],
            [1, , 1],
            [1, , 1],
            [1, , 1],
            [1, 1, 1]
        ],
        'V': [
            [1, , , , 1],
            [1, , , , 1],
            [, 1, , 1],
            [, 1, , 1],
            [, , 1]
        ],
        'W': [
            [1, , , , 1],
            [1, , , , 1],
            [1, , , , 1],
            [1, , 1, , 1],
            [1, 1, 1, 1, 1]
        ],
        'X': [
            [1, , , , 1],
            [, 1, , 1],
            [, , 1],
            [, 1, , 1],
            [1, , , , 1]
        ],
        'Y': [
            [1, , 1],
            [1, , 1],
            [, 1],
            [, 1],
            [, 1]
        ],
        'Z': [
            [1, 1, 1, 1, 1],
            [, , , 1],
            [, , 1],
            [, 1],
            [1, 1, 1, 1, 1]
        ],
        '0': [
            [1, 1, 1],
            [1, 0, 1],
            [1, 0, 1],
            [1, 0, 1],
            [1, 1, 1]
        ],
        '1': [
            [0, 1],
            [0, 1],
            [0, 1],
            [0, 1],
            [0, 1]
        ],
        '2': [
            [1,1,1],
            [0,0,1],
            [1,1,1],
            [1,0,0],
            [1,1,1]
        ],
        '3':[
            [1,1,1],
            [0,0,1],
            [1,1,1],
            [0,0,1],
            [1,1,1]
        ],
        '4':[
            [1,0,1],
            [1,0,1],
            [1,1,1],
            [0,0,1],
            [0,0,1]
        ],
        '5':[
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,1],
            [1,1,1]
        ],
        '6':[
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [1,0,1],
            [1,1,1]
        ],
        '7':[
            [1,1,1],
            [0,0,1],
            [0,0,1],
            [0,0,1],
            [0,0,1]
        ],
        '8':[
            [1,1,1],
            [1,0,1],
            [1,1,1],
            [1,0,1],
            [1,1,1]
        ],
        '9':[
            [1,1,1],
            [1,0,1],
            [1,1,1],
            [0,0,1],
            [1,1,1]
        ],
        '+':[
            [,1,],
            [,1,],
            [1,1,1],
            [,1,],
            [,1,]
        ],
        '-':[
            [,,],
            [,,],
            [1,1,1],
            [,,],
            [,,]
        ],
        ' ': [
            [, ,],
            [, ,],
            [, ,],
            [, ,],
            [, ,]
        ],
        '.': [
            [,],
            [,],
            [,],
            [,],
            [1]
        ],
        ':': [
            [,],
            [1],
            [,],
            [1],
            [,]
        ],
        '?': [
            [1,0],
            [0,1],
            [1,0],
            [0,0],
            [1,0]
        ],
        '!': [
            [1],
            [1],
            [1],
            [0],
            [1]
        ],
        '(': [
            [0,1],
            [1,0],
            [1,0],
            [1,0],
            [0,1]
        ],
        ')': [
            [1,0],
            [0,1],
            [0,1],
            [0,1],
            [1,0]
        ]
    };

    function drawString(context, string, X, Y, size, max_width, color="black") {
        context.save();
        let words = []
        let needed = [];
        string = string.toUpperCase(); // because I only did uppercase letters
        for (let i = 0; i < string.length; i++) {
            let letter = letters[string.charAt(i)];
            if (letter) { // because there's letters I didn't do
                needed.push(letter);
            }

            if(string.charAt(i) == ' '){
                words.push(needed)
                needed = [];
            }
        }

        words.push(needed)
        
        // TODO: Replace with font color
        context.fillStyle = color;

        let currX = X;
        let currY = Y;


        let currX_MAX = currX

        for(let w=0; w<words.length; w++) {
            word = words[w]
            
            // Determine space necessary for word
            let needed_space = 0
            for (i = 0; i < word.length; i++) {
                let addX = 0;
                letter = word[i];
                for (let y = 0; y < letter.length; y++){
                    let row = letter[y];
                    addX = Math.max(addX, row.length * size);
                }
                needed_space += size + addX;
            }
            
            if(needed_space+currX-X > max_width){
                currX = X
                currY += 6;
            }

            // Proceed to draw word normally
            for (i = 0; i < word.length; i++) {
                let addX = 0;
                letter = word[i];
                for (let y = 0; y < letter.length; y++){
                    let row = letter[y];
                    addX = Math.max(addX, row.length * size);
                    for (let x = 0; x < row.length; x++) {
                        if (row[x]) {
                            context.fillRect(currX + x * size, currY+y*size, size, size);
                        }
                    }
                }
                currX += size + addX;
            }
            currX_MAX = Math.max(currX, currX_MAX);
        }

        console.log('Drew ' + string + ' at ' + size);
        console.log('Needed space ', [currX_MAX-X+2, currY-Y+6+2]);
        context.restore();
        return [currX_MAX-X+2, currY-Y+6+2]
    }
